# Step 1: Import libraries
import pandas as pd
import numpy as np
import random
import matplotlib.pyplot as plt
import seaborn as sns

# Step 2: Generate sample dataset (100 movies)
np.random.seed(42)
genres = ['Action', 'Comedy', 'Drama', 'Thriller', 'Romance', 'Horror', 'Sci-Fi', 'Fantasy']
sample_data = {
    'movieId': np.arange(1, 101),
    'title': [f'Movie {i}' for i in range(1, 101)],
    'genre': [random.choice(genres) for _ in range(100)],
    'rating': np.round(np.random.uniform(1, 5, 100), 1),  # Ratings between 1 and 5
    'userId': np.random.randint(1, 31, 100),              # 30 hypothetical users
}
df = pd.DataFrame(sample_data)

# Step 3: Clean and preprocess the data
df = df.drop_duplicates()
df = df.dropna()
df['genre'] = df['genre'].astype('category')

# Step 4: Calculate summary statistics
mean_rating = df['rating'].mean()
median_rating = df['rating'].median()
mode_rating = df['rating'].mode()[0]

# Step 5: Visualize the distribution of ratings

plt.figure(figsize=(14, 5))

# Histogram with KDE
plt.subplot(1, 2, 1)
sns.histplot(df['rating'], bins=15, kde=True, color='skyblue')
plt.title('Rating Distribution (Histogram & KDE)')
plt.xlabel('Rating')
plt.ylabel('Frequency')

# Boxplot
plt.subplot(1, 2, 2)
sns.boxplot(x=df['rating'], color='salmon')
plt.title('Boxplot of Ratings')
plt.xlabel('Rating')

plt.tight_layout()
plt.show()

# Step 6: Identify top-rated movies
top_movies = df.nlargest(10, 'rating')[['movieId', 'title', 'genre', 'rating']]
print("Top 10 Rated Movies:")
print(top_movies)

# Step 7: Identify top genres by average rating
genre_avg = df.groupby('genre')['rating'].mean().sort_values(ascending=False)
print("\nTop Genres by Average Rating:")
print(genre_avg)

# Plot top genres
plt.figure(figsize=(8,4))
genre_avg.plot(kind='bar', color='teal')
plt.ylabel('Avg Rating')
plt.title('Average Rating by Genre')
plt.xticks(rotation=45)
plt.show()

# Step 8: Print summary statistics
print(f"\nSummary Statistics:\nMean Rating: {mean_rating:.2f}\nMedian Rating: {median_rating:.2f}\nMode Rating: {mode_rating:.2f}")

# Step 9: Display first 10 rows of the data
print("\nFirst 10 rows of the sample dataset (for reference):")
print(df.head(10))
